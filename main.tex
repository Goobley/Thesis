% This template was written by John Davies <john.davies@glasgow.ac.uk> 2017-02-06
% It matches the university specification at the time of writing
%   for the widths of the page margins and one-and-a-half line spacing
% You may want to include more packages, particularly for heavy mathematics
% Please let me know if you find any errors or wish to suggest improvements

\documentclass[12pt,titlepage,oneside]{book}
\usepackage[pdftex,    colorlinks=true,    bookmarksnumbered=true,    linkcolor=blue,
  urlcolor=blue,    citecolor=blue,       bookmarksopen=false,  pagebackref=true,
  pdfauthor={},    pdftitle={},    pdfkeywords={},
  pdfsubject={},    pdfcreator={},
  pdfproducer={}, pdfencoding=auto, psdextra, breaklinks=true]{hyperref}
  %% Use draft option in hyperref for tracking down ``endlink'' nexting errors

%% set line stretch if required
\usepackage{setspace}
\setstretch{1.5}

%% Graphics
\usepackage[pdftex]{graphicx, xcolor}
\graphicspath{{./Figures/}}
\usepackage{float}
\usepackage{pdfpages, rotating}
\definecolor{lightGrey}{rgb}{0.9,0.9,0.9}
\definecolor{Red}{rgb}{1.0,0.0,0.0}
\definecolor{TolBlue}{HTML}{0077BB}
\definecolor{TolCyan}{HTML}{33BBEE}
\definecolor{TolTeal}{HTML}{009988}
\definecolor{TolOrange}{HTML}{EE7733}
\definecolor{TolRed}{HTML}{CC3311}
\definecolor{TolMagenta}{HTML}{EE3377}
\definecolor{TolGrey}{HTML}{BBBBBB}
%% \usepackage{pgfplots}
%% \pgfplotsset{compat=1.10}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,fit,arrows,intersections,external,decorations}
\tikzexternalize[prefix=TikzGen/]

%% Fonts and dummy text
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} % modern encoding
\usepackage{etoolbox}
% \usepackage{mathpple}
% \usepackage[default,regular,black]{sourceserifpro}
% \usepackage[scaled=0.85]{beramono}
\usepackage{amsfonts,amssymb,amsmath}
% \usepackage{fourier}
% \usepackage[charter]{mathdesign}
% \usepackage[notext, nosf, nott]{kpfonts}
\usepackage[default,regular,semibold]{sourceserifpro}
\usepackage[small, T1]{eulervm}
\usepackage[scale=0.8, semibold]{sourcecodepro}
\usepackage{sourcesanspro}
\usepackage{gensymb}
\usepackage[f]{esvect}
% \usepackage[italic]{mathastext}
% \makeatletter

% \DeclareSymbolFont{EulerLetters}{T1}{zeur}{m}{n}
% NOTE(cmo): This will only work with euler but will replace v in math mode with
% \upsilon, which I personally never use. letters symbol font drawn directly
% from euler.sty
% Don't use this one, see below.
% \DeclareMathSymbol{v}{\mathalpha}{letters}{"1D}
% \DeclareMathSymbol{v}{\mathalpha}{letters}{"1D}

% https://tex.stackexchange.com/q/611645/50104
% Thanks to Ulrike Fischer who found a solution that doesn't break urls. But
% shouldn't be necessary now

% \DeclareMathSymbol{\REALV}{\mathalpha}{letters}{`v}
% \DeclareMathSymbol{v}{\mathalpha}{letters}{"0A}
% \makeatletter
% \appto\UrlSpecials{\do\v{\REALV}}
% \makeatother

% Experiments adjusting characters
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \DeclareSymbolFont{SSFLetters}{OT1}{\sfdefault}{m}{n}
% \DeclareSymbolFont{CMletters}{OML}{cmm}{m}{it}
% https://tex.stackexchange.com/a/27536/50104
% \DeclareFontEncoding{FML}{}{}%
% \DeclareFontSubstitution{FML}{futm}{m}{it}%
% \DeclareSymbolFont{fourier}{FML}{futm}{m}{it}
% \DeclareMathSymbol{\nu}{\mathalpha}{fourier}{23}

% \DeclareMathSymbol{v}{\mathalpha}{fourier}{`v}
% % \DeclareMathSymbol{v}{\mathalpha}{SSFLetters}{`v}
% % \DeclareMathSymbol{\nu}{\mathalpha}{CMletters}{23}
% \DeclareMathSymbol{v}{\mathalpha}{CMletters}{`v}
% \makeatother
% \usepackage{concmath}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{lipsum}

\renewcommand{\mathbf}{\mathbold} %for Eulervm, uses bold instead of bf
% \let\oldhat\hat
% \renewcommand{\vec}[1]{\vv{#1}} %vec uses esvect
% \renewcommand{\hat}[1]{\oldhat{\mathbf{#1}}}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\row}{row}
\DeclareMathOperator{\cols}{col}
\DeclareMathOperator{\nul}{null}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\nullity}{nullity}
\DeclareMathOperator{\range}{range}
\DeclareMathOperator{\image}{image}
\DeclareMathOperator{\mathion}{ion}

% \usepackage{eurosym}
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
  \usepackage{microtype}
  % \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
% Comment out the next three lines of LaTeX if you wish to use Computer Modern fonts
%   (this is the default for LaTeX)
% Make sure that your TeX installation can produce good pdf with these fonts.
% The following three lines are a good alternative if you don't use much mathematics
% \usepackage{mathptmx}  % uses Times for text and mathematics
% \usepackage[scaled]{helvet} %  helvetica for sanserif, scaled 95% by default
% \usepackage{courier}  % courier for typewriter font, pretty ugly but available
% otherwise the stix package offers more options and symbols
% \usepackage{stix}  % uses Times for text and a range of fonts for mathematics
% End of choices for fonts
% \usepackage{graphicx}  % standard package for importing graphics files
% \usepackage{cite}  % improves format of numerical citations, such as [1-3]
\usepackage[top=1.8cm,bottom=1.8cm,left=4.0cm,
            right=1.5cm,headheight=15pt,includeheadfoot]{geometry}
% These margins are the university guidelines
% \usepackage[onehalfspacing]{setspace}  % gives one-and-a-half line spacing
% doublespacing is another option and can be changed in the text
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
% \fancyhead[L]{\slshape CMJ Osborne}
% \fancyhead[L]{\slshape \leftmark}
\fancyhead[R]{\nouppercase{\rightmark}}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0.2pt}
\renewcommand{\footrulewidth}{0.2pt}
\newlength{\quarterPage}
\setlength{\quarterPage}{7.42cm}
\usepackage[update,prepend]{epstopdf}

\usepackage[toc,page]{appendix}

% \usepackage{abstract}
% \renewcommand{\abstractnamefont}{\normalfont\bfseries}
% \renewcommand{\abstracttextfont}{\normalfont}

\usepackage[UKenglish]{babel}
\usepackage{natbib}

\setcitestyle{aasjournal}
\setcitestyle{aysep={}}
\bibliographystyle{aasjournal}
\setlength\bibsep{0.2\baselineskip}

\usepackage{listings}
\usepackage{accsupp}
% Line number printing mechanism
\newcommand{\emptyaccsupp}[1]{\BeginAccSupp{ActualText={}}#1\EndAccSupp{}}
\lstset{
  basicstyle=\footnotesize\ttfamily,
  numbers=left,
  firstnumber=1,
  stepnumber=5,
  numberfirstline=true,
  backgroundcolor=\color[RGB]{248,248,248},
  showstringspaces=false,
  breaklines=true,
  numberstyle=\footnotesize\emptyaccsupp,
  keywordstyle=\color[rgb]{0.13,0.29,0.53}\bfseries,
  stringstyle=\color[rgb]{0.31,0.60,0.02},
  commentstyle=\color[rgb]{0.56,0.35,0.01}\itshape,
}
\usepackage{fancyvrb}
\VerbatimFootnotes
\usepackage{longtable,booktabs}
\usepackage{grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% $if(links-as-notes)$
% % Make links footnotes instead of hotlinks:
% \renewcommand{\href}[2]{#2\footnote{\url{#1}}}
% $endif$
\usepackage[normalem]{ulem}
% avoid problems with \sout in headers with hyperref:
\pdfstringdefDisableCommands{\renewcommand{\sout}{}}
\setlength{\parindent}{1.5em}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

%% Add extra \usepackage{...}'s here
\usepackage{siunitx}
\sisetup{detect-all}
\usepackage{parskip}
\usepackage{pgf}
\usepackage{pythontex}
% NOTE(cmo): Swap to deptythontex if you need to use the `depythontex' utility
% to see what code has been generated!
% \usepackage[depythontex]{pythontex}
\usepackage{import}
\setpythontexcontext{figurewidth=\the\columnwidth}
\newcommand{\includepgf}[1]{\IfFileExists{#1}{\input{#1}}{}}

\newcommand*{\Ca}{Ca\,\textsc{ii}}
\newcommand*{\Caii}{Ca\,\textsc{ii}}
\newcommand*{\Caiii}{Ca\,\textsc{iii}}
\newcommand*{\CaLine}{Ca\,\textsc{ii} \SI{854.2}{\nano\m}}
\newcommand*{\Ha}{H$\alpha$}
\newcommand*{\Radyn}{RADYN}
\newcommand*{\Lw}{\textit{Lightweaver}}
\newcommand*{\MsLw}{\textit{MsLightweaver}}
\newcommand*{\Sota}{state-of-the-art}
\newcommand*{\NeedRef}{{\color{Red} REF}}
\newcommand*{\ExpandMe}{{\color{Red} EXPAND}}
\newcommand*{\TODO}[1]{{\color{Red} TODO: #1}}
\newcommand*{\varv}{\upsilon}
\DeclareSIUnit\erg{erg}

\begin{document}
\include{PythonTexSetup}
\begin{titlepage}
\centering
\vspace*{1cm}  % Need the * or the space is swallowed at the top of the page
\bfseries\Large
Casting a New Light on Radiative Transfer in\\Solar Flare Models:
Synthesis and Inversion\\
\vspace{2cm}
\normalfont\large{\bfseries{
Christopher M. J. Osborne\\
}}
\vspace{1.5cm}
Submitted in fulfillment of the requirements for the\\
degree of Doctor of Philosophy\\
\vspace{1.5cm}
Astronomy and Astrophysics Group\\
School of Physics and Astronomy\\
University of Glasgow\\
\vspace{1cm}
\includegraphics[width=0.6\columnwidth]{GlaLogo.pdf}
\\
\vspace{1cm}
% Insert month and year of date deposited with library for final version
September 2021
\end{titlepage}
\frontmatter  % Turn off chapter numbering, use roman page numbers
\thispagestyle{plain}
\vspace*{0.4\textheight}
\begin{center}
\noindent\begin{minipage}{0.8\textwidth}
\emph{I send you this letter on a falling star. Reentry will score and test it but will not melt it away. I write in fire across the sky, a plummet to match your rise.}
\end{minipage}
% \rule{0.8\textwidth}
\end{center}
\noindent\hspace*{0.1\textwidth}\rule{0.8\textwidth}{1pt}\hspace*{0.1\textwidth}
\begin{flushright}
  {This Is How You Lose the Time War\hspace*{0.1\textwidth}}
  \\
  {\small--- Amal El-Mohtar \& Max Gladstone}
\end{flushright}
\include{Misc/Abstract}
\tableofcontents
\listoftables
\listoffigures
\include{Misc/Acknowledgements}
\include{Misc/Declaration}

\mainmatter % Turn on chapter numbering, reset page numbers, use arabic
\include{00Introduction/Introduction}
\include{01aFlareModelling/FlareModelling}
\include{01bFlareObservations/FlareObservations}
\include{02TimeDepRT/TimeDepRT}
\include{03TwoDRT/2DRT}
\include{04Radynversion/Radynversion}
\include{Misc/ConcludingRemarks}
\appendix

% {\setstretch{1.0}\small
{\small
\bibliography{{Refs}}}

\backmatter  % Turn off chapter numbering

\end{document}
